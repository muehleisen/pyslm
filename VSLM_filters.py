# VSLM_filters.py
# This file returns 5th order IIR filter coefficients for A and C weighted filters for
# a given sampling frequency of 22, 44, 48, or 96 kHz.
#
#
# The filter coefficients created by generating a freq response curve in MATLAB
# The freq response curve is generated using the ANSI S1.42 and MATLAB freqs
# The filter coefficients were found by inverting freq response curve using MATLAB invfreqz
# This is far accurate than using the bilinear transform
# b coefficients are the numerators, a coefficients are the denominators


def awt_design(fs):
    # choose filter coefficients based on sampling frequency

    if abs(fs - 22050) < 0.001:
        # created with adesign4e22k.m and N=1399
        a = [1.00000000000000, -0.820486371642917, -0.954967112698490, 0.819769137019238, -0.0308133150879904]
        b = [0.411130459349308, 0.489163899078409, -1.81511690197873, 0.505982131319440, 0.408895901518515]
        # created with adesign4225k.m and N=11 in Matlab 2017b
        a = [1.00000000000000,0.114040617064988,-1.73962632814722,-0.0588672583643397,0.752706928653449,-0.0421365973763140]
        b = [0.479724137567424,0.698352793642956,-1.28579268684870,-1.08324447380469,0.806141262716181,0.384957320118693]

    elif abs(fs - 44100) < 0.001:
     #    # created with adesign4e44k.m and N=66
     #    a = [1.00000000000000, -3.16548213635874, 3.58370028028808, -1.66952594339746, 0.251312323839929]
     #    b = [0.218436284008832, -0.0271197371604133, -1.23075568024016, 1.66912752925371, -0.629688397944900]
     # # created with adesign 4f44k and N=156 in Matlab 2017b
     #    a = [1.00000000000000,-2.17391413966464,0.435790608317221,1.91049786875723,-1.42986973046128,0.257504618754223]
     #    b = [0.197328330738941,0.295700203460341,-1.48214531617682,0.696075221882438,0.884846720247170,-0.591805163941482]


        # created with adesign4g44k with N=37
        a = [1.00000000000000,-1.13380111850101,-0.767736600912980,1.11607493426612,-0.211637095346173]
        b = [0.226881693464684,0.398073493367644,-0.792345594395459,-0.521884519254478,0.689289044049529]


    elif abs(fs - 48000) < 0.001:
        # # created with adesign4e48k and N=1331
        # a = [1.00000000000000, -3.21098152161547, 3.70934390304575, -1.78459093140491, 0.286231936413823]
        # b = [0.180459241142510, 0.0860957271342434, -1.34233754417886, 1.70455253682352, -0.628769962323045]


        # a = [1.00000000000000,-2.58953854506865,1.72091993636967,0.500192330832148,-0.803108471926028,0.171540310842999]
        # b = [0.193527818264011,0.128801050269222,-1.13385637374743,0.691362328790360,0.536003760430611,-0.415838586620141]


        # created with adesign4g48k Nmin =  35

        a = [1.00000000000000,-1.99083845480561,1.04650792315814,-0.0252817494253919,-0.0289733018304139]
        b = [0.210770391732308,0.193711163810021,-0.827304441834406,0.227788110346714,0.195041790455940]


    else:
        # # created with adesign4e96k and N
        # a = [1.00000000000000, -3.52292032961222, 4.59276248551295, -2.61658164419795, 0.546739755260711]
        # b = [-0.0930424680674304, 0.885061570433706, -2.09736158642518, 1.91170857911392, -0.606366095212699]



        # a = [1.00000000000000,-2.90327981585914,2.39759801841681,0.265595075471317,-1.11057263491615,0.350659796526762]
        # b = [0.0871733996183503,-0.0472826493278016,0.140103528544142,-1.00900347220785,1.35096034791848, -0.521951154744965]

        # created with adesign4g96k and N85
        a = [1.00000000000000,-1.35823756682346,-0.641981542958832,1.37867777247531,-0.337251906082069,-0.0407558956919498]
        b = [0.177399743490700,-0.0399890448858935,-0.270599641197704,0.606282482552152,-1.12956988090320,0.656478624060042]


    return [b, a]

def cwt_design(fs):

    if fs == 22050:
        # created with cdesign4e22k and N=1470
        a = [1.00000000000000, 0.487110438920731, -1.19411745882897, -0.473099276797724, 0.208201319236022]
        b = [0.403673160421101, 0.867939940009175, -0.387869031048492, -0.871337058723055, -0.0191991534215092]

    elif fs == 44100:
        # created with cdesign4e44k and N=1186
        a = [1.00000000000000, 0.720524473037467, -1.27460941890720, -0.711991070511022, 0.283142933498142]
        b = [0.205377794209128, 0.731122249663226, 0.318817527196078, -0.733113968701055, -0.526187064231238]

    elif fs == 48000:
        # created with cdesign4e48k and N=1102
        a = [1.00000000000000, 0.678016119469390, -1.28615510047168, -0.687899298538665, 0.312313266344913]
        b = [0.210715717951749, 0.718855215372106, 0.245507756808660, -0.716973939314165, -0.462053117024141]

    else:
        # created with cdesign4e96k and N=1201
        a = [1.00000000000000, -2.93939917852114, 3.10634442611301, -1.39372064867588, 0.226775918992396]
        b = [0.0484465929621835, 0.151813149050837, -0.459174213032651, 0.269122623377235, -0.0102081523621007]

    return [b, a]
